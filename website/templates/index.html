<!doctype html>
<html lang="en">
   <head>
      <title>ACP Controle Times</title>
      <meta charset="utf-8">
      <!-- 'viewport' is used by bootstrap to respond to device size -->
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      <!-- Bootstrap includes javascript and css  (must follow jquery) -->
      <link
         rel="stylesheet"
         href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
         integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l"
         crossorigin="anonymous">
      <!-- Javascript:  JQuery from a content distribution network (CDN) -->
      <script
         src="https://code.jquery.com/jquery-3.5.1.min.js"
         integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
         crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
         integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
         crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js"
         integrity="sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF"
         crossorigin="anonymous"></script>
      <!-- moment.js is the JavaScript equivalent of arrow.py -->
      <script
      src="{{ url_for('static', filename="js/moment.min.js") }}"></script>
   </head>
   <!-- Our own stylesheet -->
   <link rel="stylesheet" href="/static/css/calc.css" />
   <body>
      <div class="container">
         <h1>ACP Brevet Data Displayer</h1>
         <!--
            If there are any warnings or other messages from a prior
            request to the server,
            they appear above the rest of the content, just until the next
            action.  (This is only on request/response transactions that
            result in regenerating the page, not on every request.)
            -->

         <!-- Design on bootstrap grid -->
         <form role="form" >
               <div class="col-md-12">
                    <button id="submit">List All</button>
                    <button id="display">List Open</button>
                    <button id="display">List Close</button>
                    <input type="checkbox" id="csv" name="csv"checked>                  
  					<label for="csv">csv</label>
                    <br></br>
  					<label for="top">TOP:</label>
  					<input type="text" id="top" name="top">
               </div>
            </div>
         </form>
         <script type="text/javascript">
  
            function calc_times(control) {

                $('#display').click(
                    function(e) {
                    e.preventDefault();
                    window.location.replace("/displayroute");
                    // redirect to /displayroute
                 });
                
                $('#submit').click(
                   // make javascript array and then push all values from html to array and then send 
                    function(e) {
                    e.preventDefault();
                    var brevet_data = [];
                    $('.control').each(
                        function(index, obj)
                        {
                            var kms = $(obj).find("input[name='km']").val();
                            var open = $(obj).find("input[name='open']").val();
                            var close = $(obj).find("input[name='close']").val();
                            console.log(index);
                            console.log(kms);
                            if (kms) {
                                brevet_data.push({kms: kms, open: open, close: close});
                                window.alert("Submitted Brevet control distance, open, and close times.");
                            }
                            console.log(brevet_data);
                        });
                    $.post("/someroute", {brevet_data: JSON.stringify(brevet_data)},
                        function(response) 
                            {console.log("response:", response.output)}, "json");
                    // calculate all the non-empty fields
                 });
              });
         </script>
      </div>
   </body>
</html>
